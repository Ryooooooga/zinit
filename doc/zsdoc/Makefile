# This Makefile is to convert supplied Asciidoc files into
# other formats like pdf and man. The files contain Zplugin's
# code documentation.
#
# *.adoc files are generated by Makefile from upper (i.e. top)
# directory.
SRC := share/{'git-process-output','rpm2cpio'}.zsh zinit{'','-additional','-autoload','-install','-side'}.zsh
DOC_SRC := $(foreach wrd,$(SRC),../$(wrd))
all: man pdf

# MANUALS
# Converted with a2x from asciidoc package

man: man/zinit.zsh.1 man/zinit-side.zsh.1 man/zinit-install.zsh.1 man/zinit-autoload.zsh.1

man/zinit.zsh.1:
	@mkdir -p man
	a2x --verbose -L --doctype manpage --format manpage -D man zinit.zsh.adoc

man/zinit-side.zsh.1:
	@mkdir -p man
	a2x --verbose -L --doctype manpage --format manpage -D man zinit-side.zsh.adoc

man/zinit-install.zsh.1:
	@mkdir -p man
	a2x --verbose -L --doctype manpage --format manpage -D man zinit-install.zsh.adoc

man/zinit-autoload.zsh.1:
	@mkdir -p man
	a2x --verbose -L --doctype manpage --format manpage -D man zinit-autoload.zsh.adoc

# PDFS
# Uses asciidoctor not a2x (i.e. not asciidoc)

pdf: git-process-output.zsh.pdf rpm2cpio.zsh.pdf zinit-autoload.zsh.pdf zinit-install.zsh.pdf zinit-side.zsh.pdf zinit.zsh.pdf

git-process-output.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf git-process-output.zsh.adoc
rpm2cpio.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf rpm2cpio.zsh.adoc
zinit-additional.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf zinit-additional.zsh.adoc
zinit-autoload.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf zinit-autoload.zsh.adoc
zinit-install.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf zinit-install.zsh.adoc
zinit-side.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf zinit-side.zsh.adoc
zinit.zsh.pdf:
	asciidoctor -a reproducible -b pdf -r asciidoctor-pdf -D pdf zinit.zsh.adoc

clean:
	rm -rf man pdf data

.PHONY: all clean man test

# vim:noet:sts=8:ts=8
